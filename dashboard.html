<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Wallet Sentinel - Dashboard</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css"/>
    
    <!-- Custom Global CSS -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/global.css') }}"/>
    
    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    
    <style>
        /* Animação dourada */
        @keyframes goldTransition {
            0% { color: #b8860b; }
            50% { color: #ffd700; }
            100% { color: #b8860b; }
        }

        .gold-text {
            animation: goldTransition 3s linear infinite;
        }

        /* Texto Verde (Money) */
        .money-text {
            color: #228B22; /* Verde escuro */
        }

        /* Sidebar */
        .sidebar {
            transition: width 0.3s;
        }
        .sidebar:hover {
            width: 250px;
        }

        /* Animações de hover nos itens do menu */
        .nav-item {
            transition: background-color 0.3s, transform 0.3s;
        }
        .nav-item:hover {
            background-color: #4a5568;
            transform: translateX(10px);
        }

        .nav-icon {
            transition: transform 0.3s;
        }
        .nav-item:hover .nav-icon {
            transform: rotate(360deg);
        }

        /* Botão de logout */
        .logout-btn {
            transition: background-color 0.3s, transform 0.3s;
        }
        .logout-btn:hover {
            background-color: #4a5568;
            transform: translateX(10px);
        }

        .logout-icon {
            transition: transform 0.3s;
        }
        .logout-btn:hover .logout-icon {
            transform: rotate(360deg);
        }

        /* Efeito Roxo e Brilho */
        .purple-text {
            color: #800080; /* Roxo */
            font-weight: bold;
        }

        @keyframes starGlow {
            0% {
                text-shadow: 0 0 5px #fff, 0 0 10px #800080, 0 0 15px #800080;
            }
            50% {
                text-shadow: 0 0 10px #fff, 0 0 20px #800080;
            }
            100% {
                text-shadow: 0 0 5px #fff, 0 0 10px #800080;
            }
        }

        .star-glow {
            animation: starGlow 2s infinite;
        }

        /* Área de inclusão de despesas */
        .despesas-container {
            display: none;
        }
        
        /* Estilo para o formulário de despesas */
        .form-control {
            @apply bg-gray-700 text-white px-3 py-2 rounded;
        }
        
        /* Checkbox personalizado */
        .custom-checkbox {
            @apply flex items-center justify-center;
        }
        
        .custom-checkbox input[type="checkbox"] {
            @apply w-4 h-4 mr-2;
        }
    </style>
</head>
<body class="bg-gray-900 text-white flex">
    <!-- Sidebar -->
    <div class="sidebar w-64 min-h-screen bg-gray-800 flex flex-col justify-between">
        <div class="p-4">
            <h1 class="text-3xl font-semibold mb-6 money-text">Wallet</h1>
            <!-- Sidebar navigation items -->
            <nav>
                <ul>
                    <li class="nav-item mb-4 flex items-center">
                        <i class="nav-icon fas fa-coins mr-3"></i>
                        <a href="#" class="text-gray-300 hover:text-white" id="adicionar-despesa-btn">Adicionar Despesa</a>
                    </li>
                    <li class="nav-item mb-4 flex items-center">
                        <i class="nav-icon fas fa-money-bill-wave mr-3"></i>
                        <a href="#" class="text-gray-300 hover:text-white">Adicionar Provento</a>
                    </li>
                    <li class="nav-item mb-4 flex items-center">
                        <i class="nav-icon fas fa-star mr-3"></i>
                        <a href="#" class="text-gray-300 hover:text-white">Metas</a>
                    </li>
                </ul>
            </nav>
        </div>
        <div class="p-4">
            <button class="logout-btn flex items-center space-x-2 w-full" onclick="window.location.href='{{ url_for('logout') }}'">
                <i class="logout-icon fas fa-sign-out-alt"></i>
                <span>Logout</span>
            </button>
        </div>
    </div>

    <!-- Main content -->
    <div class="flex-1 p-6">
        <h2 class="text-2xl font-semibold mb-6">
            <span class="star-glow purple-text">Sentinel</span>
        </h2>
        <!-- Conteúdo principal -->
        <div id="despesas-container" class="despesas-container bg-gray-800 p-6 rounded-lg shadow-lg">
            <h2 class="text-2xl font-semibold mb-6">
                <span class="star-glow purple-text">Incluir Despesa</span>
            </h2>
            <form id="despesa-form">
                <div class="grid grid-cols-12 gap-4 items-end">
                    <!-- Data -->
                    <div class="col-span-2">
                        <label for="data" class="block text-sm font-medium mb-1">Data</label>
                        <input type="date" id="data" name="data" class="form-control w-full">
                    </div>
                    
                    <!-- Descrição -->
                    <div class="col-span-4">
                        <label for="descricao" class="block text-sm font-medium mb-1">Descrição</label>
                        <input type="text" id="descricao" name="descricao" class="form-control w-full">
                    </div>
                    
                    <!-- Valor -->
                    <div class="col-span-2">
                        <label for="valor" class="block text-sm font-medium mb-1">Valor</label>
                        <input type="text" id="valor" name="valor" class="form-control w-full text-right" placeholder="R$ 0,00">
                    </div>
                    
                    <!-- Tipo -->
                    <div class="col-span-2">
                        <label for="tipo" class="block text-sm font-medium mb-1">Tipo</label>
                        <select id="tipo" name="tipo" class="form-control w-full">
                            <option value="alimentacao">Alimentação</option>
                            <option value="transporte">Transporte</option>
                            <option value="moradia">Moradia</option>
                            <option value="saude">Saúde</option>
                            <option value="educacao">Educação</option>
                            <option value="lazer">Lazer</option>
                            <option value="outros">Outros</option>
                        </select>
                    </div>
                    
                    <!-- Recorrente -->
                    <div class="col-span-2 custom-checkbox">
                        <label for="recorrente" class="flex items-center text-sm font-medium cursor-pointer">
                            <input type="checkbox" id="recorrente" name="recorrente" class="rounded border-gray-600 text-purple-600">
                            <span class="ml-2">Recorrente</span>
                        </label>
                    </div>
                </div>
                
                <!-- Data Range (hidden by default) -->
                <div id="date-range" class="grid grid-cols-12 gap-4 mt-3 hidden">
                    <div class="col-span-2">
                        <label for="data_inicio" class="block text-sm font-medium mb-1">Data Início</label>
                        <input type="date" id="data_inicio" name="data_inicio" class="form-control w-full">
                    </div>
                    <div class="col-span-2">
                        <label for="data_fim" class="block text-sm font-medium mb-1">Data Fim</label>
                        <input type="date" id="data_fim" name="data_fim" class="form-control w-full">
                    </div>
                </div>
                
                <!-- Submit Button -->
                <div class="mt-4">
                    <button type="submit" class="btn w-full flex items-center justify-center">
                        <i class="fas fa-plus mr-2"></i> Incluir Despesa
                    </button>
                </div>
            </form>
            
            <h2 class="text-2xl font-semibold mt-8 mb-4">
                <span class="star-glow purple-text">Despesas Recentes</span>
            </h2>
            
            <div class="flex gap-2 mb-4">
                <button id="edit-btn" class="btn flex items-center justify-center">
                    <i class="fas fa-edit mr-2"></i> Editar
                </button>
                <button id="delete-btn" class="btn bg-red-600 hover:bg-red-700 flex items-center justify-center">
                    <i class="fas fa-trash mr-2"></i> Excluir
                </button>
            </div>
            
            <div class="overflow-x-auto">
                <table class="min-w-full bg-gray-700 rounded-lg overflow-hidden">
                    <thead class="bg-gray-600">
                        <tr>
                            <th class="p-3 text-center w-16">
                                <input type="checkbox" id="select-all">
                            </th>
                            <th class="p-3 text-left">Data</th>
                            <th class="p-3 text-left">Descrição</th>
                            <th class="p-3 text-right">Valor</th>
                            <th class="p-3 text-left">Tipo</th>
                        </tr>
                    </thead>
                    <tbody id="despesas-tabela">
                        <!-- Despesas serão adicionadas aqui -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <script>
        $(document).ready(function() {
            $('#adicionar-despesa-btn').click(function() {
                $('#despesas-container').toggle();
            });

            $('#recorrente').change(function() {
                if (this.checked) {
                    $('#date-range').removeClass('hidden');
                } else {
                    $('#date-range').addClass('hidden');
                }
            });

            // Select all checkboxes
            $('#select-all').change(function() {
                $('tbody input[type="checkbox"]').prop('checked', $(this).prop('checked'));
            });

            $('#despesa-form').submit(function(event) {
                event.preventDefault();
                const data = $('#data').val();
                const dataFormatada = formatarData(data);
                const descricao = $('#descricao').val();
                const valor = $('#valor').val();
                const tipo = $('#tipo option:selected').text();
                
                const novaDespesa = `<tr class="hover:bg-gray-600">
                                        <td class="p-3 text-center"><input type="checkbox" class="item-check"></td>
                                        <td class="p-3">${dataFormatada}</td>
                                        <td class="p-3">${descricao}</td>
                                        <td class="p-3 text-right">${formatarValor(valor)}</td>
                                        <td class="p-3">${tipo}</td>
                                    </tr>`;
                $('#despesas-tabela').prepend(novaDespesa);
                
                // Limpar o formulário
                $(this).trigger('reset');
                $('#date-range').addClass('hidden');
            });

            $('#edit-btn').click(function() {
                const isEditing = $(this).find('i').hasClass('fa-save');
                if (isEditing) {
                    $(this).html('<i class="fas fa-edit mr-2"></i> Editar');
                    // Save changes logic here
                    $('.editable').attr('contenteditable', false)
                                  .removeClass('bg-gray-800 editable');
                } else {
                    $(this).html('<i class="fas fa-save mr-2"></i> Salvar');
                    // Edit logic here
                    $('#despesas-tabela tr td:not(:first-child)').attr('contenteditable', true)
                                                                  .addClass('bg-gray-800 editable');
                }
            });

            $('#delete-btn').click(function() {
                $('#despesas-tabela input[type="checkbox"]:checked').closest('tr').remove();
            });
            
            // Funções auxiliares
            function formatarData(data) {
                if (!data) return '';
                const partes = data.split('-');
                return `${partes[2]}/${partes[1]}/${partes[0]}`;
            }
            
            function formatarValor(valor) {
                if (!valor) return 'R$ 0,00';
                if (!valor.startsWith('R$')) {
                    return `R$ ${valor}`;
                }
                return valor;
            }
        });
    </script>
</body>
</html>
